---
title: "Linear Regression Models"
author: "Seif Kungulio"
date: "`r Sys.Date()`"
output:
  rmdformats::readthedown
---

```{r setup, include=FALSE}
# Install necessary packages if not installed
if (!requireNamespace("readxl", quietly = TRUE)) {
  install.packages("readxl")
}

#load the data set into memory
library(readxl)

knitr::opts_chunk$set(echo = TRUE)
```

<hr style="height:5px; border:none; color:#006000; background-color:#006000" />

# **Analyze Motor Car Data Trends**
<hr style="height:2px; border:none; color:#333; background-color:#333" />

You are a data scientist in a top dealership group in USA. Your boss, Mr. Buffet, asked you to analyze the motor trend car data. You are given a dataset containing fuel consumption and 10 aspects of automobile design and performance for 32 automobiles the file mtcars.xlsx.

**Data Source:** from MASS library in R. 

## **Data Dictionary**
This dataset contains the following columns:

| **Variable** | **Data Type** | **Description** | **Constraints/Rules** |
|:-------------|:--------------|:----------------|:----------------------|
| `mpg` | Numeric | Miles per gallon | Positive values only (mpg > 0) |
| `cyl` | Integer | Number of cylinders | Categorical: {4, 6, 8} |
| `disp` | Numeric | Displacement (cubic inches) | Positive values only (disp > 0) |
| `hp` | Integer | Gross horsepower | Positive values only (hp > 0) |
| `drat` | Numeric | Rear axle ratio | Positive values only (drat > 0) |
| `wt` | Numeric | Weight (1000 lbs) | Positive values only (wt > 0) |
| `qsec` | Numeric | 1/4 mile time (seconds) | Positive values only (qsec > 0) |
| `vs` | Integer | Engine type: 0 = V-shaped, 1 = straight | Binary: {0, 1} |
| `am` | Integer | Transmission: 0 = automatic, 1 = manual | Binary: {0, 1} |
| `gear` | Integer | Number of forward gears | Categorical: {3, 4, 5} |
| `carb` | Integer | Number of carburetors | Positive integer values only |


## **Dataset Loading**

```{r}
# Load the Boston dataset
mtcars <- read_excel("data/mtcars.xlsx", sheet = "mtcars")
```

Check the dimension of the data frame
```{r}
dim(mtcars)
```

Display data frame column names
```{r}
colnames(mtcars)
```

Display data frame structures
```{r}
str(mtcars)
```

Display data frame statistical summary
```{r}
summary(mtcars)
```
<hr>

## **Question 1**
**Use the lm() function to perform a simple linear regression with the response mpg and the predictor hp.**

Visualize the data pairwise  
```{r fig.width=12, fig.height=8}
pairs(mtcars[,c("mpg","hp")])
```

Build the simple linear model  
```{r}
simple_model = lm(mpg ~ hp, data = mtcars)
```

Print out the model results  
```{r}
summary(simple_model)
```

<hr>

## **Question 2** 
**Is there a relationship between the target mpg and predator hp?**

**Yes**, the t-test for hp results in a p-value of 2.72e-09, which is significantly low, indicating a strong relationship. Since this is a simple linear regression, the F-test yields the same conclusion:

+ t-value = -7.658
+ Squaring the t-value: (-7.658)^2 = 58.65, which equals the F-value

Thus, the p-values from both the t-test and F-test are identical in this case.


<hr>

## **Question 3**
**How strong is the relationship between the response and predictor?**

The p-value from the t-test is far below the **0.05** threshold, indicating a **strong relationship** between the predictor and the response variable. Additionally, the R^2 value suggests that this variable alone explains **60%** of the variation in the model. The F-test can also serve as a useful indicator.

<hr>

## **Question 4**
**Is the relationship between mpg and hp positive or negative?**

**Negative**, as hp goes up, mpg goes down.

<hr>

## **Question 5**
**What is the predicted mpg associated with a horsepower (hp) of 100? Whatâ€™s the 95% confidence interval for the predicted mpg?**

Predict mpg for hp = 100 with 95% confidence interval  
```{r}
predicted_mpg <- predict(simple_model, data.frame(hp = 100), 
                         interval = "confidence", level = 0.95)
```

Print the predicted mpg  
```{r}
predicted_mpg
```

<hr>

## **Question 6**
**Plot the response and the predictor and add the regression line using abline().**

Plot the response and predictor with the regression line  
```{r fig.width=12, fig.height=8}
plot(mtcars$hp, mtcars$mpg, main = "MPG vs Horsepower",
     xlab = "Horsepower (hp)", ylab = "Miles per Gallon (mpg)")
abline(simple_model, lwd = 2, col = "blue")
```

<hr>

## **Question 7**
**Perform a multiple linear regression with mpg as the response and the predictors cyl, disp, hp, wt, vs, and gear. Print out the results using summary() function.**

Perform multiple linear regression  
```{r}
multiple_model <- lm(mpg ~ cyl + disp + hp + wt + vs + gear, data = mtcars)
```

Print the summary of the model  
```{r}
summary(multiple_model)
```

<hr>

## **Question 8**
**Is there a relationship between the predictors and the response?**

**Yes**, some predictors show a significant relationship with the response variable, as evidenced by the F-statistic of 30.5 and a p-value of 2.568e-12.

<hr>

## **Question 9**
**Which predictors appears to have a statistically significant relationship to the response?**

The variables **wt** (weight) and **hp** (gross horsepower) have p-values of **0.00012** and **0.02**, respectively, based on their t-tests.

<hr>

## **Question 10**
**Use * symbols to fit linear regression models with interaction effects between hp and wt. Does this interaction appear to be statistically significant?**

Fit a model with interaction effects between hp and wt  
```{r}
interaction_model <- lm(mpg ~ hp * wt, data = mtcars)
```

Print the summary of the interaction model  
```{r}
summary(interaction_model)
```

**Yes**, the interaction has a p-value of 0.000362 < alpha = 0.05

<hr>
